// Core logic and NSSI engine